<script id="ABConvert-theme-test">
var abconvertThemeTestLiquidVariables = { 
    abconvertThemeId : {{ theme.id }},
    abconvertDesignMode:{{request.design_mode}}
};

Object.keys(abconvertThemeTestLiquidVariables).forEach(function(key) { window[key] =
    abconvertThemeTestLiquidVariables[key]; });
var abconvertThemeTestDict = {"experimentId":"66def4db4f4dee6e1567f3f6","testGroups":[{"name":"Original","percentage":50,"theme":{"id":"170516611340","name":"Mix & Match Testrelease","screenshotUrl":"https://abconvert-public-image-production.s3.us-east-1.amazonaws.com/ono-mao.myshopify.com-1725886414172","_id":"66def4db4f4dee6e1567f3f8"},"paymentCustomization":[],"deliveryCustomization":[],"checkoutUICustomization":[],"shippingCost":2,"profitMargin":30,"_id":"66def4db4f4dee6e1567f3f7","testProducts":[]},{"name":"Variant","percentage":50,"theme":{"id":"170545021196","name":"AB Test (Add to Cart Button)","screenshotUrl":"https://abconvert-public-image-production.s3.us-east-1.amazonaws.com/ono-mao.myshopify.com-1725886412743","_id":"66def4db4f4dee6e1567f3fa"},"paymentCustomization":[],"deliveryCustomization":[],"checkoutUICustomization":[],"shippingCost":2,"profitMargin":30,"_id":"66def4db4f4dee6e1567f3f9","testProducts":[]}],"themeIdMap":{"170516611340":true,"170545021196":true},"startTime":"2024-09-09T13:15:07.899Z","themeTestConditionType":"include","themeTestConditions":[{"conditionType":"page_url","condition":"contains","value":"/products/","_id":"66def4db4f4dee6e1567f3fb"}]};
 window.abconvertThemeTestDict = abconvertThemeTestDict;
(()=>{"use strict";async function e(){localStorage.getItem("abconvert-country")||await async function(){const e=await fetch("https://app.abconvert.io/api/public/get-country-code",{method:"GET",mode:"cors"}),t=(await e.json()).countryCode;t&&(console.log("successfully set country code: ",t),localStorage.setItem("abconvert-country",t))}()}const t=[/Googlebot/,/Googlebot-Image/,/Googlebot-Video/,/Googlebot-News/,/Storebot-Google/,/Google-InspectionTool/,/GoogleOther/,/Google-Extended/,/APIs-Google/,/AdsBot-Google-Mobile/,/AdsBot-Google/,/Mediapartners-Google/,/Google-Safety/,/FeedFetcher-Google/,/GoogleProducer/,/Bingbot/,/Slurp/,/DuckDuckBot/,/Baiduspider/,/YandexBot/,/facebot/,/Twitterbot/],n={NEW:"new",RETURNING:"returning",ALL:"all"},o=async(e,t,n=null)=>{const o={method:t,mode:"cors",headers:{"Content-Type":"application/json"}};n&&(o.body=JSON.stringify(n));let r=150,i=0;for(;i<3;)try{const t=await fetch(e,o);if(t.ok)return t.json();throw new Error(await t.json())}catch(e){if(r*=2,i+=1,i>=3)throw e;await new Promise((e=>setTimeout(e,r)))}throw new Error("API Error")};function r(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}function i(e,t,n){var o,r=new Date;r.setTime(r.getTime()+n),o="; expires="+r.toUTCString(),document.cookie=e+"="+(t||"")+o+"; path=/"}function a(){let e=r("abconvert-landing-page");return e||(e=window.location.pathname,i("abconvert-landing-page",e,18e5)),e}function s(){let e=r("abconvert-session");return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),i("abconvert-session",e,18e5)),e}function c(e){const t=(new Date).valueOf(),o=localStorage.getItem("abconvert-first-visit-time")?Number(localStorage.getItem("abconvert-first-visit-time")):t;return localStorage.getItem("abconvert-first-visit-time")||localStorage.setItem("abconvert-first-visit-time",t.toString()),o>(e=new Date(e).valueOf())?n.NEW:n.RETURNING}let l,d,u=0,m=0,h=!1;const v=()=>{h?(h=!1,d=(new Date).getTime(),m+=(d-l)/1e3):(h=!0,l=(new Date).getTime())};window.addEventListener("scroll",(()=>{u+=1.8,v()}));const g="https://app.abconvert.io";var w=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},p=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};w(void 0,void 0,void 0,(function(){function n(){var e=new URLSearchParams(location.search),t=e.get("preview"),n=e.get("countryCode");return n&&window.sessionStorage.setItem("abconvert-country",n),t&&!isNaN(Number(t))?(window.sessionStorage.setItem("abconvert-preview-number",t),t):window.sessionStorage.getItem("abconvert-preview-number")}function l(e,t,n){switch(t){case b.MATCHES_EXACTLY:return e===n;case b.MATCHES_REGEX_EXACTLY:return new RegExp(n).test(e);case b.CONTAINS:return e.includes(n);case b.ENDS_WITH:return e.endsWith(n);case b.STARTS_WITH:return e.startsWith(n);case b.NOT_MATCH_EXACTLY:return e!==n;case b.NOT_MATCH_REGEX_EXACTLY:return!new RegExp(n).test(e);case b.NOT_CONTAINS:return!e.includes(n);case b.NOT_ENDS_WITH:return!e.endsWith(n);case b.NOT_STARTS_WITH:return!e.startsWith(n);default:return!1}}function d(e){var t,o,r,i,a=(null===(o=null===(t=window.Shopify)||void 0===t?void 0:t.theme)||void 0===o?void 0:o.id)||window.abconvertThemeId,s=e.testGroups,d=e.experimentId,u=e.themeTestConditionType,m=e.themeTestConditions,h=e.startTime,v=(r=s,(i=n())&&!isNaN(Number(i))?Number(i)>=r.length?0:Number(i):function(e){var t,n=function(){var e=localStorage.getItem("abconvert-seed");return null==e&&(e=Math.floor(100*Math.random()).toString(),localStorage.setItem("abconvert-seed",e)),e}(),o=0;for(t=0;t<e.length;++t)if(o+=e[t].percentage,Number(n)<o)return t;return t}(r)),g=!0;if(!e.selectedVistorType||e.selectedVistorType==c(h)){u&&(u===f.EXCLUDE&&(g=!m.some((function(e){return l(window.location.pathname,e.condition,e.value)}))),u===f.INCLUDE&&(g=m.some((function(e){return l(window.location.pathname,e.condition,e.value)})))),g||(v=0),function(){var e=n();return e&&!isNaN(Number(e))}()||!localStorage.getItem("abconvert-theme-test-".concat(d))&&g&&localStorage.setItem("abconvert-theme-test-".concat(d),JSON.stringify({experimentId:d,groupIndex:v,startTime:h}));var w=s[v].theme;if(w.id!=a){window.localStorage.setItem("abconvert-is-redirected-test-theme","true");var p=new URLSearchParams(location.search);p.set("preview_theme_id",w.id.toString()),location.search=p.toString()}}}function h(e){var t,n,l=(null===(n=null===(t=window.Shopify)||void 0===t?void 0:t.theme)||void 0===n?void 0:n.id)||window.abconvertThemeId,d=e.experimentId,h=e.themeIdMap,f=e.testGroups,b=g+"/api/analytics/theme/originalview",T=g+"/api/analytics/theme/click",y=g+"/api/analytics/theme/bounce",S=g+"/api/analytics/theme/staying-time";if(h[window.abconvertThemeId]&&(!e.selectedVistorType||e.selectedVistorType===c(e.startTime))){var x=localStorage.getItem("abconvert-theme-test-".concat(d)),I=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}("abconvert-theme-test-stay-time-recorded-".concat(d));if(x){var N=JSON.parse(x).groupIndex;f[N].theme.id==l&&(function(e){var t,n,r,i,a,s,c=e.experimentId,l=e.groupIndex;w(this,void 0,void 0,(function(){var e,d,u,m,h,v,g,w,f;return p(this,(function(p){switch(p.label){case 0:p.trys.push([0,7,,8]),e=0,p.label=1;case 1:return e<10?[4,o((null!==(r=null===(n=null===(t=null===window||void 0===window?void 0:window.Shopify)||void 0===t?void 0:t.routes)||void 0===n?void 0:n.root)&&void 0!==r?r:"/")+"cart.js","GET")]:[3,6];case 2:return d=p.sent(),console.log("[LOG] Original cart attributes: ",d.attributes),u=d.attributes,m={},u["abconvert-theme"]&&(m=JSON.parse(u["abconvert-theme"])),m[c]=l,h={"abconvert-theme":JSON.stringify(m)},console.log("[LOG] New cart attributes: ",h),u["abconvert-theme"]&&u["abconvert-theme"]==JSON.stringify(m)?[3,4]:(v={"Content-Type":"application/json"},g=(null!==(s=null===(a=null===(i=null===window||void 0===window?void 0:window.Shopify)||void 0===i?void 0:i.routes)||void 0===a?void 0:a.root)&&void 0!==s?s:"/")+"cart/update.js",w=JSON.stringify({attributes:h}),[4,fetch(g,{method:"POST",headers:v,body:w})]);case 3:return p.sent().ok?console.log("[LOG] Successfully update cart attributes"):console.log("Failed to update cart attributes"),[3,5];case 4:return[3,6];case 5:return e++,[3,1];case 6:return[3,8];case 7:return f=p.sent(),console.log("[ERROR] Update cart attributes: ",f),[3,8];case 8:return[2]}}))}))}({experimentId:d,groupIndex:N}),async function(e,t,n,o){const r=s(),i=window.location.pathname.toString(),l=a();fetch(e,{method:"POST",body:JSON.stringify({sessionId:r,experimentId:t,groupIndex:n,visitorType:c(o),pathName:i,landingPage:l}),keepalive:!0})}(b,d,N,e.startTime),function(e,t,n,o){const r=window.location.pathname.toString(),i=a();window.addEventListener("click",(a=>{if("A"===a.target.tagName){const l=a.target.getAttribute("href");console.log(l);const d=s();fetch(e,{method:"POST",body:JSON.stringify({sessionId:d,experimentId:t,groupIndex:n,link:l,visitorType:c(o),pathName:r,landingPage:i}),keepalive:!0})}}))}(T,d,N,e.startTime),function(e,t,n,o){const r=window.location.pathname.toString(),i=a();let l=!1;window.addEventListener("scroll",(()=>{l=!0})),window.addEventListener("click",(()=>{l=!0})),window.addEventListener("beforeunload",(async()=>{if(!l){const a=s();fetch(e,{method:"POST",body:JSON.stringify({sessionId:a,experimentId:t,groupIndex:n,visitorType:c(o),pathName:r,landingPage:i}),keepalive:!0})}}))}(y,d,N,e.startTime),I||function(e,t,n,o,l){const d=(new Date).getTime(),h=window.location.pathname.toString(),g=a();r(`abconvert-${t}-test-stay-time-recorded-${n}`)||(i(`abconvert-${t}-test-stay-time-recorded-${n}`,!0,18e5),setInterval((()=>{(new Date).getTime()-d>39e3&&v()}),39e3),window.addEventListener("beforeunload",(async()=>{const t=s(),r=(new Date).getTime(),i=(r-d)/1e3,a=(r-d)/1e3-u/1e3-m;fetch(e,{method:"POST",body:JSON.stringify({stayingTime:i,stayingTimeAdjusted:a,sessionId:t,experimentId:n,groupIndex:o,visitorType:c(l),pathName:h,landingPage:g}),keepalive:!0})})))}(S,"theme",d,N,e.startTime))}}}var f,b,T;return p(this,(function(n){f={EXCLUDE:"exclude",INCLUDE:"include"},b={MATCHES_EXACTLY:"match_exactly",MATCHES_REGEX_EXACTLY:"match_regex_exactly",CONTAINS:"contains",ENDS_WITH:"ends_with",STARTS_WITH:"starts_with",NOT_MATCH_EXACTLY:"not_match_exactly",NOT_MATCH_REGEX_EXACTLY:"not_match_regex_exactly",NOT_CONTAINS:"not_contains",NOT_ENDS_WITH:"not_ends_with",NOT_STARTS_WITH:"not_starts_with"},T=function(){var e;localStorage.getItem("shopURL")||window.Shopify&&window.Shopify.shop&&(e=window.Shopify.shop,localStorage.setItem("shopURL",e),console.log("[LOG] Template test: set shop url"))},console.log("[ABConvert] Running ABConvert Theme test 1.0.0 - hide preview bar + add country filter and device filter");try{if(window.Shopify?.designMode||window.abconvertDesignMode)return[2];localStorage.getItem("abconvert-user-seed")||localStorage.setItem("abconvert-user-seed","0"),T(),a(),document.addEventListener("DOMContentLoaded",T),function(){var n,o;w(this,void 0,void 0,(function(){var r,i,a,s,c,l,u;return p(this,(function(m){switch(m.label){case 0:return(()=>{const e=navigator.userAgent;return t.some((t=>t.test(e)))})()?[2]:window.abconvertThemeTestDict?(r=window.abconvertThemeTestDict.themeIdMap,i=new URLSearchParams(location.search).get("preview_theme_id")||"",a=(null===(o=null===(n=window.Shopify)||void 0===n?void 0:n.theme)||void 0===o?void 0:o.id)||window.abconvertThemeId,i&&!r[Number(i)]||a&&!r[a]?[2]:window.abconvertThemeTestDict.isFilteredByCountry?[4,e()]:[3,2]):[3,3];case 1:m.sent(),m.label=2;case 2:if((s=document.createElement("style")).textContent="\n                    #preview-bar-iframe {\n                        display: none !important;\n                    }\n                    /* Add more CSS rules here */\n                ",document.head.appendChild(s),window.abconvertThemeTestDict.isFilteredByCountry&&(c=localStorage.getItem("abconvert-country"),!window.abconvertThemeTestDict.filteredCountries.includes(c)))return[2];if(window.abconvertThemeTestDict.isFilteredByDevice&&(l=function(){const e=navigator.userAgent||window.opera;return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)?"mobile":/ipad|playbook|silk/i.test(e)?"tablet":"desktop"}(),u=window.abconvertThemeTestDict.selectedDevice,l!==u))return[2];d(window.abconvertThemeTestDict),h(window.abconvertThemeTestDict),m.label=3;case 3:return[2]}}))}))}()}catch(e){console.log("[ABConvert] Theme test error: ",e.message)}return[2]}))}))})();
</script>