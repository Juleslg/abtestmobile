<script id="ABConvert-theme-test">
var abconvertThemeTestLiquidVariables = { 
    abconvertThemeId : {{ theme.id }},
    abconvertDesignMode:{{request.design_mode}}
};

Object.keys(abconvertThemeTestLiquidVariables).forEach(function(key) { window[key] =
    abconvertThemeTestLiquidVariables[key]; });
var abconvertThemeTestDict = {"experimentId":"6712dbf9be172447e6b7c0af","testGroups":[{"name":"Original","percentage":50,"theme":{"id":"173005996300","name":"Release Minis - Teller und SchÃ¼ssel","_id":"6712dbf9be172447e6b7c0b1"},"paymentCustomization":[],"deliveryCustomization":[],"checkoutUICustomization":[],"shippingCost":2,"profitMargin":30,"_id":"6712dbf9be172447e6b7c0b0","testProducts":[]},{"name":"Variant","percentage":50,"theme":{"id":"172919980300","name":"abtestmobile/main","screenshotUrl":"https://abconvert-public-image-production.s3.us-east-1.amazonaws.com/ono-mao.myshopify.com-1728684970775","_id":"6712dbf9be172447e6b7c0b3"},"paymentCustomization":[],"deliveryCustomization":[],"checkoutUICustomization":[],"shippingCost":2,"profitMargin":30,"_id":"6712dbf9be172447e6b7c0b2","testProducts":[]}],"themeIdMap":{"173005996300":true,"172919980300":true},"startTime":"2024-10-18T22:06:49.939Z","isFilteredByDevice":true,"selectedDevice":"mobile"};
 window.abconvertThemeTestDict = abconvertThemeTestDict;
(()=>{"use strict";async function e(){localStorage.getItem("abconvert-country")||await async function(){const e=await fetch("https://app.abconvert.io/api/public/get-country-code",{method:"GET",mode:"cors"}),t=(await e.json()).countryCode;t&&(console.log("successfully set country code: ",t),localStorage.setItem("abconvert-country",t))}()}function t(){return localStorage.getItem("abconvert-country")}const n=[/Googlebot/,/Googlebot-Image/,/Googlebot-Video/,/Googlebot-News/,/Storebot-Google/,/Google-InspectionTool/,/GoogleOther/,/Google-Extended/,/APIs-Google/,/AdsBot-Google-Mobile/,/AdsBot-Google/,/Mediapartners-Google/,/Google-Safety/,/FeedFetcher-Google/,/GoogleProducer/,/Bingbot/,/Slurp/,/DuckDuckBot/,/Baiduspider/,/YandexBot/,/facebot/,/Twitterbot/],o={NEW:"new",RETURNING:"returning",ALL:"all"},r=async(e,t,n=null)=>{const o={method:t,mode:"cors",headers:{"Content-Type":"application/json"}};n&&(o.body=JSON.stringify(n));let r=150,i=0;for(;i<3;)try{const t=await fetch(e,o);if(t.ok)return t.json();throw new Error(await t.json())}catch(e){if(r*=2,i+=1,i>=3)throw e;await new Promise((e=>setTimeout(e,r)))}throw new Error("API Error")};function i(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}function a(e,t,n){var o,r=new Date;r.setTime(r.getTime()+n),o="; expires="+r.toUTCString(),document.cookie=e+"="+(t||"")+o+"; path=/"}function s(){let e=i("abconvert-landing-page");return e||(e=window.location.pathname,a("abconvert-landing-page",e,18e5)),e}function c(){let e=i("abconvert-session");return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),a("abconvert-session",e,18e5)),e}function l(e){const t=(new Date).valueOf(),n=localStorage.getItem("abconvert-first-visit-time")?Number(localStorage.getItem("abconvert-first-visit-time")):t;return localStorage.getItem("abconvert-first-visit-time")||localStorage.setItem("abconvert-first-visit-time",t.toString()),n>(e=new Date(e).valueOf())?o.NEW:o.RETURNING}let d,u,m=0,h=0,v=!1;const g=()=>{v?(v=!1,u=(new Date).getTime(),h+=(u-d)/1e3):(v=!0,d=(new Date).getTime())};function w(e,t,n,o,r){const d=(new Date).getTime(),u=window.location.pathname.toString(),v=s();i(`abconvert-${t}-test-stay-time-recorded-${n}`)||(a(`abconvert-${t}-test-stay-time-recorded-${n}`,!0,18e5),setInterval((()=>{(new Date).getTime()-d>39e3&&g()}),39e3),window.addEventListener("beforeunload",(async()=>{const t=c(),i=(new Date).getTime(),a=(i-d)/1e3,s=(i-d)/1e3-m/1e3-h;fetch(e,{method:"POST",body:JSON.stringify({stayingTime:a,stayingTimeAdjusted:s,sessionId:t,experimentId:n,groupIndex:o,visitorType:l(r),pathName:u,landingPage:v}),keepalive:!0})})))}window.addEventListener("scroll",(()=>{m+=1.8,g()}));const p="https://app.abconvert.io";var f=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},b=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};f(void 0,void 0,void 0,(function(){function o(){var e=new URLSearchParams(location.search),t=e.get("preview"),n=e.get("countryCode");return n&&window.sessionStorage.setItem("abconvert-country",n),t&&!isNaN(Number(t))?(window.sessionStorage.setItem("abconvert-preview-number",t),t):window.sessionStorage.getItem("abconvert-preview-number")}function i(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1,r.length);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return null}function a(e,t,n){switch(t){case h.MATCHES_EXACTLY:return e===n;case h.MATCHES_REGEX_EXACTLY:return new RegExp(n).test(e);case h.CONTAINS:return e.includes(n);case h.ENDS_WITH:return e.endsWith(n);case h.STARTS_WITH:return e.startsWith(n);case h.NOT_MATCH_EXACTLY:return e!==n;case h.NOT_MATCH_REGEX_EXACTLY:return!new RegExp(n).test(e);case h.NOT_CONTAINS:return!e.includes(n);case h.NOT_ENDS_WITH:return!e.endsWith(n);case h.NOT_STARTS_WITH:return!e.startsWith(n);default:return!1}}function d(e){var t,n,r,i,s=(null===(n=null===(t=window.Shopify)||void 0===t?void 0:t.theme)||void 0===n?void 0:n.id)||window.abconvertThemeId,c=e.testGroups,d=e.experimentId,u=e.themeTestConditionType,h=e.themeTestConditions,v=e.startTime,g=(r=c,(i=o())&&!isNaN(Number(i))?Number(i)>=r.length?0:Number(i):function(e){var t,n=function(){var e=localStorage.getItem("abconvert-seed");return null==e&&(e=Math.floor(100*Math.random()).toString(),localStorage.setItem("abconvert-seed",e)),e}(),o=0;for(t=0;t<e.length;++t)if(o+=e[t].percentage,Number(n)<o)return t;return t}(r)),w=!0;if(!e.selectedVistorType||e.selectedVistorType==l(v)){u&&(u===m.EXCLUDE&&(w=!h.some((function(e){return a(window.location.pathname,e.condition,e.value)}))),u===m.INCLUDE&&(w=h.some((function(e){return a(window.location.pathname,e.condition,e.value)})))),w||(g=0),function(){var e=o();return e&&!isNaN(Number(e))}()||!localStorage.getItem("abconvert-theme-test-".concat(d))&&w&&localStorage.setItem("abconvert-theme-test-".concat(d),JSON.stringify({experimentId:d,groupIndex:g,startTime:v}));var p=c[g].theme;if(p.id!=s){window.localStorage.setItem("abconvert-is-redirected-test-theme","true");var f=new URLSearchParams(location.search);f.set("preview_theme_id",p.id.toString()),location.search=f.toString()}}}function u(){var o,a;return f(this,void 0,void 0,(function(){var u,m,h,v,g,T,y;return b(this,(function(S){switch(S.label){case 0:return(()=>{const e=navigator.userAgent;return n.some((t=>t.test(e)))})()?[2]:window.abconvertThemeTestDict?(u=window.abconvertThemeTestDict.themeIdMap,m=new URLSearchParams(location.search).get("preview_theme_id")||"",h=(null===(a=null===(o=window.Shopify)||void 0===o?void 0:o.theme)||void 0===a?void 0:a.id)||window.abconvertThemeId,m&&!u[Number(m)]||h&&!u[h]?[2]:window.abconvertThemeTestDict.isFilteredByCountry?[4,e()]:[3,2]):[3,3];case 1:S.sent(),S.label=2;case 2:if((v=document.createElement("style")).textContent="\n                    #preview-bar-iframe {\n                        display: none !important;\n                    }\n                    /* Add more CSS rules here */\n                ",document.head.appendChild(v),window.abconvertThemeTestDict.isFilteredByCountry&&(g=t(),!window.abconvertThemeTestDict.filteredCountries.includes(g)))return[2];if(window.abconvertThemeTestDict.isFilteredByDevice&&(T=function(){const e=navigator.userAgent||window.opera;return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(e)?"mobile":/ipad|playbook|silk/i.test(e)?"tablet":"desktop"}(),y=window.abconvertThemeTestDict.selectedDevice,T!==y))return[2];d(window.abconvertThemeTestDict),function(n){var o,a,d=(null===(a=null===(o=window.Shopify)||void 0===o?void 0:o.theme)||void 0===a?void 0:a.id)||window.abconvertThemeId,u=n.experimentId,m=n.themeIdMap,h=n.testGroups,v=p+"/api/analytics/theme/originalview",g=p+"/api/analytics/theme/click",T=p+"/api/analytics/theme/bounce",y=p+"/api/analytics/theme/staying-time";if(m[window.abconvertThemeId]&&(!n.selectedVistorType||n.selectedVistorType===l(n.startTime))){var S=localStorage.getItem("abconvert-theme-test-".concat(u)),x=i("abconvert-theme-test-stay-time-recorded-".concat(u));if(S){var I=JSON.parse(S).groupIndex;h[I].theme.id==d&&(function(n){var o,a,s,c,l,d,u,m=n.experimentId,h=n.groupIndex;f(this,void 0,void 0,(function(){var n,v,g,w,p,f,T,y,S;return b(this,(function(b){switch(b.label){case 0:b.trys.push([0,8,,9]),n=0,b.label=1;case 1:return n<10?[4,e()]:[3,7];case 2:return b.sent(),[4,r((null!==(s=null===(a=null===(o=null===window||void 0===window?void 0:window.Shopify)||void 0===o?void 0:o.routes)||void 0===a?void 0:a.root)&&void 0!==s?s:"/")+"cart.js","GET")];case 3:return v=b.sent(),console.log("[LOG] Original cart attributes: ",v.attributes),g=v.attributes,w={},g["abconvert-theme"]&&(w=JSON.parse(g["abconvert-theme"])),w[m]=h,p={"abconvert-theme":JSON.stringify(w),abconvertCountry:t(),abconvertSearchParams:null!==(c=i("abconvert-search-params"))&&void 0!==c?c:""},console.log("[LOG] New cart attributes: ",p),g["abconvert-theme"]&&g["abconvert-theme"]==JSON.stringify(w)?[3,5]:(f={"Content-Type":"application/json"},T=(null!==(u=null===(d=null===(l=null===window||void 0===window?void 0:window.Shopify)||void 0===l?void 0:l.routes)||void 0===d?void 0:d.root)&&void 0!==u?u:"/")+"cart/update.js",y=JSON.stringify({attributes:p}),[4,fetch(T,{method:"POST",headers:f,body:y})]);case 4:return b.sent().ok?console.log("[LOG] Successfully update cart attributes"):console.log("Failed to update cart attributes"),[3,6];case 5:return[3,7];case 6:return n++,[3,1];case 7:return[3,9];case 8:return S=b.sent(),console.log("[ERROR] Update cart attributes: ",S),[3,9];case 9:return[2]}}))}))}({experimentId:u,groupIndex:I}),async function(e,t,n,o){const r=c(),i=window.location.pathname.toString(),a=s();fetch(e,{method:"POST",body:JSON.stringify({sessionId:r,experimentId:t,groupIndex:n,visitorType:l(o),pathName:i,landingPage:a}),keepalive:!0})}(v,u,I,n.startTime),function(e,t,n,o){const r=window.location.pathname.toString(),i=s();window.addEventListener("click",(a=>{if("A"===a.target.tagName){const s=a.target.getAttribute("href");console.log(s);const d=c();fetch(e,{method:"POST",body:JSON.stringify({sessionId:d,experimentId:t,groupIndex:n,link:s,visitorType:l(o),pathName:r,landingPage:i}),keepalive:!0})}}))}(g,u,I,n.startTime),function(e,t,n,o){const r=window.location.pathname.toString(),i=s();let a=!1;window.addEventListener("scroll",(()=>{a=!0})),window.addEventListener("click",(()=>{a=!0})),window.addEventListener("beforeunload",(async()=>{if(!a){const a=c();fetch(e,{method:"POST",body:JSON.stringify({sessionId:a,experimentId:t,groupIndex:n,visitorType:l(o),pathName:r,landingPage:i}),keepalive:!0})}}))}(T,u,I,n.startTime),x||w(y,"theme",u,I,n.startTime))}}}(window.abconvertThemeTestDict),S.label=3;case 3:return[2]}}))}))}var m,h,v;return b(this,(function(e){m={EXCLUDE:"exclude",INCLUDE:"include"},h={MATCHES_EXACTLY:"match_exactly",MATCHES_REGEX_EXACTLY:"match_regex_exactly",CONTAINS:"contains",ENDS_WITH:"ends_with",STARTS_WITH:"starts_with",NOT_MATCH_EXACTLY:"not_match_exactly",NOT_MATCH_REGEX_EXACTLY:"not_match_regex_exactly",NOT_CONTAINS:"not_contains",NOT_ENDS_WITH:"not_ends_with",NOT_STARTS_WITH:"not_starts_with"},v=function(){var e;localStorage.getItem("shopURL")||window.Shopify&&window.Shopify.shop&&(e=window.Shopify.shop,localStorage.setItem("shopURL",e),console.log("[LOG] Template test: set shop url"))},console.log("[ABConvert] Running ABConvert Theme test 1.0.0 - hide preview bar + add country filter and device filter");try{if(window.Shopify?.designMode||window.abconvertDesignMode)return[2];localStorage.getItem("abconvert-user-seed")||localStorage.setItem("abconvert-user-seed","0"),v(),s(),document.addEventListener("DOMContentLoaded",v),u()}catch(e){console.log("[ABConvert] Theme test error: ",e.message)}return[2]}))}))})();
</script>